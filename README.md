# Image Metadata Storyteller

A React application that extracts EXIF metadata from uploaded images and uses Google's Gemini AI to generate creative narrative stories based on the hidden data within your photos.

## Features

- ğŸ“¸ **Image Upload**: Drag-and-drop image upload powered by Uppy
- ğŸ” **Metadata Extraction**: Server-side EXIF metadata extraction from JPG, PNG, TIFF, and WEBP images
- ğŸ¨ **Perceptual Hashing**: Client-side visual fingerprinting for future duplicate detection
- ğŸ¤– **AI Story Generation**: Creative narratives generated by Google Gemini based on image metadata
- ğŸ’¾ **Supabase Integration**: Edge Functions for serverless metadata processing

## Prerequisites

- **Node.js** (v18 or higher recommended)
- **Docker** (for local Supabase development)
- **Supabase CLI** (install via `npm install -g supabase`)
- **Google Gemini API Key** (get one at [aistudio.google.com](https://aistudio.google.com))

## Local Development

### 1. Install Dependencies
```bash
npm install
```

### 2. Configure Environment
Create a `.env.local` file in the project root:
```
GEMINI_API_KEY=your_gemini_api_key_here
```

### 3. Start Supabase (Required)
```bash
supabase start
```
This starts a local Supabase instance with PostgreSQL and Edge Functions on port 54321.

### 4. Run the App
```bash
npm run dev
```
The app will be available at [http://localhost:3000](http://localhost:3000)

## Project Structure

```
/
â”œâ”€â”€ App.tsx                      # Main application component
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ UppyUploader.tsx         # File upload interface
â”‚   â”œâ”€â”€ MetadataDisplay.tsx      # Metadata and story display
â”‚   â””â”€â”€ Icons.tsx                # SVG icons
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ geminiService.ts         # Google Gemini AI integration
â”‚   â”œâ”€â”€ mediaService.ts          # Perceptual hash generation
â”‚   â”œâ”€â”€ configService.ts         # Metadata configuration loader
â”‚   â””â”€â”€ supabaseService.ts       # Supabase client (stub)
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ functions/
â”‚   â”‚   â”œâ”€â”€ process-upload/      # Main metadata extraction endpoint
â”‚   â”‚   â””â”€â”€ extract-metadata/    # Alternative extraction endpoint
â”‚   â””â”€â”€ migrations/              # Database schema migrations
â”œâ”€â”€ metadata.json                # EXIF tag configuration
â””â”€â”€ vite.config.ts              # Vite bundler configuration
```

## How It Works

1. User uploads an image via the Uppy interface
2. Image is posted to Supabase Edge Function (`process-upload`)
3. Server extracts EXIF metadata using the `exifr` library
4. Client generates a perceptual hash of the image
5. Metadata is sent to Google Gemini for creative story generation
6. Results are displayed in an interactive interface

## Database Schema

The app includes migrations for a `media_metadata` table that can store:
- File information (name, type, size)
- EXIF metadata (JSON)
- Perceptual hashes for duplicate detection
- Hamming distance function for similarity comparison

## Build for Production

```bash
npm run build
```
Output will be in the `dist/` directory.

## Technologies

- **Frontend**: React 19, TypeScript, Vite
- **File Upload**: Uppy
- **AI**: Google Gemini 2.5 Flash
- **Backend**: Supabase Edge Functions (Deno)
- **Database**: PostgreSQL (via Supabase)
- **Image Processing**: exifr, blockhash-js

## License

MIT

## AI Studio

This project was scaffolded from Google AI Studio. View the original app at: https://ai.studio/apps/drive/19DcgZ9yN-Afb8vXOCHdy_wcMhEHdapEy
